# Fabric Solution Configuration Template
# This template represents a Fabric solution, in YAML.
# We'll be expanding this template as move through the project!

# Solution Version - important! This will be injected into all resource names (e.g., av01, av02, av03)
solution_version: "av01"

# Azure Configuration
azure:
  subscription_id: "${AZURE_SUBSCRIPTION_ID}" # Set via environment variable
  tenant_id: "${AZURE_TENANT_ID}" # Set via environment variable

  # Entra ID Security Groups (Object IDs) - for workspace permissions
  # Replace these with your actual Entra ID Group Object IDs
  security_groups:
    sg-adv-analysts: "5b1325e2-a338-4ab3-bd53-beb297531443"
    sg-adv-engineers: "d6abd4ab-c515-4ab9-ba88-ba4f518f1f0d"
    sg-adv-consumers: "b53467e7-238a-43fc-8e63-e4a6d237bac5"

  # Default settings for all Fabric capacities, saves us having to write them out each time
  capacity_defaults:
    resource_group: "rg-dojo-adv01" # Azure Resource Group for all capacities
    region: "southafricanorth"
    sku: "F2"
    capacity_admins: "${SPN_OBJECT_ID}" # Capacity administrators loaded from environment variable (comma-separated Object IDs)

github:
  repository: "fabric-dojo-project-adv"
  branch: "main"
  provider: "GitHub"

# Fabric Capacities
capacities:
  - name: "fc{{SOLUTION_VERSION}}devengineering"
  - name: "fc{{SOLUTION_VERSION}}testengineering"
  - name: "fc{{SOLUTION_VERSION}}prodengineering"
  - name: "fc{{SOLUTION_VERSION}}devconsumption"
  - name: "fc{{SOLUTION_VERSION}}testconsumption"
  - name: "fc{{SOLUTION_VERSION}}prodconsumption"

# Fabric Workspaces
workspaces:
  - name: "{{SOLUTION_VERSION}}-dev-processing"
    capacity: "fc{{SOLUTION_VERSION}}devengineering"
    permissions:
      - group: "sg-adv-engineers"
        role: "Admin"
    connect_to_git_folder: "solution/processing/"
  - name: "{{SOLUTION_VERSION}}-dev-datastores"
    capacity: "fc{{SOLUTION_VERSION}}devengineering"
    permissions:
      - group: "sg-adv-engineers"
        role: "Admin"
    connect_to_git_folder: "solution/datastores/"
  - name: "{{SOLUTION_VERSION}}-dev-consumption"
    capacity: "fc{{SOLUTION_VERSION}}devengineering"
    permissions:
      - group: "sg-adv-engineers"
        role: "Admin"
    connect_to_git_folder: "solution/consumption/"
  - name: "{{SOLUTION_VERSION}}-test-processing"
    capacity: "fc{{SOLUTION_VERSION}}testengineering"
    permissions:
      - group: "sg-adv-engineers"
        role: "Admin"
  - name: "{{SOLUTION_VERSION}}-test-datastores"
    capacity: "fc{{SOLUTION_VERSION}}testengineering"
    permissions:
      - group: "sg-adv-engineers"
        role: "Admin"
  - name: "{{SOLUTION_VERSION}}-test-consumption"
    capacity: "fc{{SOLUTION_VERSION}}testconsumption"
    permissions:
      - group: "sg-adv-engineers"
        role: "Admin"
  - name: "{{SOLUTION_VERSION}}-prod-processing"
    capacity: "fc{{SOLUTION_VERSION}}prodengineering"
    permissions:
      - group: "sg-adv-engineers"
        role: "Admin"
  - name: "{{SOLUTION_VERSION}}-prod-datastores"
    capacity: "fc{{SOLUTION_VERSION}}prodengineering"
    permissions:
      - group: "sg-adv-engineers"
        role: "Admin"
      - group: "sg-adv-analysts"
        role: "Contributor"
  - name: "{{SOLUTION_VERSION}}-prod-consumption"
    capacity: "fc{{SOLUTION_VERSION}}prodconsumption"
    permissions:
      - group: "sg-adv-engineers"
        role: "Admin"
      - group: "sg-adv-analysts"
        role: "Contributor"
      - group: "sg-adv-consumers"
        role: "Viewer"